# encoding: UTF-8
# frozen_string_literal: true

describe CoinAPI::BTC do
  let(:client) { CoinAPI[:btc] }

  around do |example|
    WebMock.disable_net_connect!
    example.run
    WebMock.allow_net_connect!
  end

  before do
    if respond_to?(:request_body) && respond_to?(:response_body)
      stub_request(:post, 'http://127.0.0.1:18332/').with(body: request_body).to_return(body: response_body)
    end
  end

  describe '#create_address!' do
    subject { client.create_address! }

    let :request_body do
      { jsonrpc: '1.0', method: 'getnewaddress', params: [] }.to_json
    end

    let :response_body do
      { result: '2N7r9zKXkypzqtXfWkKfs3uZqKbJUhdK6JE' }.to_json
    end

    it { is_expected.to eq(address: '2N7r9zKXkypzqtXfWkKfs3uZqKbJUhdK6JE') }
  end

  describe '#load_balance!' do
    subject { client.load_balance! }

    let :request_body do
      { jsonrpc: '1.0', method: 'getbalance', params: [] }.to_json
    end

    let :response_body do
      { result: 8.07876264 }.to_json
    end

    it { is_expected.to eq('8.07876264'.to_d) }
  end

  describe '#inspect_address!' do
    subject { client.inspect_address!(address) }

    context 'valid address' do
      let(:address) { '2N7r9zKXkypzqtXfWkKfs3uZqKbJUhdK6JE' }

      let :request_body do
        { jsonrpc: '1.0', method: 'validateaddress', params: [address] }.to_json
      end

      let :response_body do
        { result: { isvalid: true, ismine: true } }.to_json
      end

      it { is_expected.to eq(address: address, is_valid: true) }
    end

    context 'invalid address' do
      subject { client.inspect_address!(address) }

      let(:address) { '2N7r9zKXkypzqtXfWkK' }

      let :request_body do
        { jsonrpc: '1.0', method: 'validateaddress', params: [address] }.to_json
      end

      let :response_body do
        { result: { isvalid: false, ismine: true } }.to_json
      end

      it { is_expected.to eq(address: address, is_valid: false) }
    end
  end

  describe '#each_deposit!' do
    subject { client.each_deposit! }

    let :request_body do
      { jsonrpc: '1.0', method: 'listtransactions', params: ['*', 100, 0] }.to_json
    end

    let :response_body do
      '{"result": [{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":596,"blocktime":1523535985,"txid":"44bbd357cbac7663a2d4b3f5ec44def42a532f89a1a48d0a930e4016812a88c1","walletconflicts":[],"time":1523535099,"timereceived":1523535099,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":596,"blocktime":1523535985,"txid":"44bbd357cbac7663a2d4b3f5ec44def42a532f89a1a48d0a930e4016812a88c1","walletconflicts":[],"time":1523535099,"timereceived":1523535099,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":608,"blocktime":1523535985,"txid":"fd0e7e0d21b000d39716df5a46399cc4087137e2dbdb3de4ff4db907ce58b9df","walletconflicts":[],"time":1523535100,"timereceived":1523535100,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":608,"blocktime":1523535985,"txid":"fd0e7e0d21b000d39716df5a46399cc4087137e2dbdb3de4ff4db907ce58b9df","walletconflicts":[],"time":1523535100,"timereceived":1523535100,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":600,"blocktime":1523535985,"txid":"d26e5de3f9a2bdc07a28175d06cf51ba1c3361ea7b8c6aec01ce6e4c798203d4","walletconflicts":[],"time":1523535101,"timereceived":1523535101,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":600,"blocktime":1523535985,"txid":"d26e5de3f9a2bdc07a28175d06cf51ba1c3361ea7b8c6aec01ce6e4c798203d4","walletconflicts":[],"time":1523535101,"timereceived":1523535101,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":616,"blocktime":1523535985,"txid":"059f5069dc50538231bfd08f68f7805bb9d25a8f96d77a60f43de341aca3b2f5","walletconflicts":[],"time":1523535102,"timereceived":1523535102,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":616,"blocktime":1523535985,"txid":"059f5069dc50538231bfd08f68f7805bb9d25a8f96d77a60f43de341aca3b2f5","walletconflicts":[],"time":1523535102,"timereceived":1523535102,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":535,"blocktime":1523535985,"txid":"68703ae38942d0f7b0c2b3a6530f445f1df1f20d2acad9d68b0a2e51681e9747","walletconflicts":[],"time":1523535102,"timereceived":1523535102,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":535,"blocktime":1523535985,"txid":"68703ae38942d0f7b0c2b3a6530f445f1df1f20d2acad9d68b0a2e51681e9747","walletconflicts":[],"time":1523535102,"timereceived":1523535102,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":571,"blocktime":1523535985,"txid":"5c7aa61e159db5a53049372fb8b76bf5bdb673ea09d0516b3fc77fe4d4d61eaa","walletconflicts":[],"time":1523535103,"timereceived":1523535103,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":571,"blocktime":1523535985,"txid":"5c7aa61e159db5a53049372fb8b76bf5bdb673ea09d0516b3fc77fe4d4d61eaa","walletconflicts":[],"time":1523535103,"timereceived":1523535103,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":559,"blocktime":1523535985,"txid":"4ed6419c482f90509adf497520bd85cd031763a0a3eede20acb0ca9a65968460","walletconflicts":[],"time":1523535104,"timereceived":1523535104,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":559,"blocktime":1523535985,"txid":"4ed6419c482f90509adf497520bd85cd031763a0a3eede20acb0ca9a65968460","walletconflicts":[],"time":1523535104,"timereceived":1523535104,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":371,"blocktime":1523535985,"txid":"b9a101a073080b4fb6b7ab5463b05597729dc4e5328c616f200ab2f9ad6a2db4","walletconflicts":[],"time":1523535106,"timereceived":1523535106,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":371,"blocktime":1523535985,"txid":"b9a101a073080b4fb6b7ab5463b05597729dc4e5328c616f200ab2f9ad6a2db4","walletconflicts":[],"time":1523535106,"timereceived":1523535106,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":590,"blocktime":1523535985,"txid":"bbdb807d38d4b4b4040d57636c82917eb665b4a0d7ad3acb5151c974e14298b0","walletconflicts":[],"time":1523535107,"timereceived":1523535107,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":590,"blocktime":1523535985,"txid":"bbdb807d38d4b4b4040d57636c82917eb665b4a0d7ad3acb5151c974e14298b0","walletconflicts":[],"time":1523535107,"timereceived":1523535107,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":489,"blocktime":1523535985,"txid":"4899faeb025c0c04654fc374e12f4496e4facadaa32e8915c5ec477b1d6c4e28","walletconflicts":[],"time":1523535107,"timereceived":1523535107,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":489,"blocktime":1523535985,"txid":"4899faeb025c0c04654fc374e12f4496e4facadaa32e8915c5ec477b1d6c4e28","walletconflicts":[],"time":1523535107,"timereceived":1523535107,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":409,"blocktime":1523535985,"txid":"bee7656389e13ff86cee781c60d22ade4c201095021cb1ddc0475f6ae3b56ee9","walletconflicts":[],"time":1523535108,"timereceived":1523535108,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":409,"blocktime":1523535985,"txid":"bee7656389e13ff86cee781c60d22ade4c201095021cb1ddc0475f6ae3b56ee9","walletconflicts":[],"time":1523535108,"timereceived":1523535108,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":392,"blocktime":1523535985,"txid":"71f469ab6683dcba1e72f1f36fc91f38ad27d78a9daf6c4db0e026162903351d","walletconflicts":[],"time":1523535109,"timereceived":1523535109,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":392,"blocktime":1523535985,"txid":"71f469ab6683dcba1e72f1f36fc91f38ad27d78a9daf6c4db0e026162903351d","walletconflicts":[],"time":1523535109,"timereceived":1523535109,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":385,"blocktime":1523535985,"txid":"c830ba718273abd19b0e14c3ac344df54918a8a1a9f653956038f7397b5264ed","walletconflicts":[],"time":1523535110,"timereceived":1523535110,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":385,"blocktime":1523535985,"txid":"c830ba718273abd19b0e14c3ac344df54918a8a1a9f653956038f7397b5264ed","walletconflicts":[],"time":1523535110,"timereceived":1523535110,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":281,"blocktime":1523535985,"txid":"2e16b910fd879ffed43d0f5af066a303348e5caf6461122027a758edc8fb6e88","walletconflicts":[],"time":1523535110,"timereceived":1523535110,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":281,"blocktime":1523535985,"txid":"2e16b910fd879ffed43d0f5af066a303348e5caf6461122027a758edc8fb6e88","walletconflicts":[],"time":1523535110,"timereceived":1523535110,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":410,"blocktime":1523535985,"txid":"b485c763abb703498c3c9911dc29b0ee9baf7e363c26311f9114c938514656b7","walletconflicts":[],"time":1523535111,"timereceived":1523535111,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":410,"blocktime":1523535985,"txid":"b485c763abb703498c3c9911dc29b0ee9baf7e363c26311f9114c938514656b7","walletconflicts":[],"time":1523535111,"timereceived":1523535111,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":572,"blocktime":1523535985,"txid":"1a844fb42be344df873bd7e0c6385412944da0346214453d706d6414e14d8b7b","walletconflicts":[],"time":1523535111,"timereceived":1523535111,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":572,"blocktime":1523535985,"txid":"1a844fb42be344df873bd7e0c6385412944da0346214453d706d6414e14d8b7b","walletconflicts":[],"time":1523535111,"timereceived":1523535111,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":386,"blocktime":1523535985,"txid":"45d3cd09957afbbc5dc985e9ccb15b66b700cf7af857989a59fa9d6460447b31","walletconflicts":[],"time":1523535112,"timereceived":1523535112,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":386,"blocktime":1523535985,"txid":"45d3cd09957afbbc5dc985e9ccb15b66b700cf7af857989a59fa9d6460447b31","walletconflicts":[],"time":1523535112,"timereceived":1523535112,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":297,"blocktime":1523535985,"txid":"8ecd307512ee1886a929bfe8cbbfa34eda54800a911ca67fa6c2a6fb909be4a9","walletconflicts":[],"time":1523535113,"timereceived":1523535113,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":297,"blocktime":1523535985,"txid":"8ecd307512ee1886a929bfe8cbbfa34eda54800a911ca67fa6c2a6fb909be4a9","walletconflicts":[],"time":1523535113,"timereceived":1523535113,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":588,"blocktime":1523535985,"txid":"24ee10d5d155fcf4e261be8b0ec5c677e4bef987c13b7d7d484913cfa08e74a1","walletconflicts":[],"time":1523535113,"timereceived":1523535113,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":588,"blocktime":1523535985,"txid":"24ee10d5d155fcf4e261be8b0ec5c677e4bef987c13b7d7d484913cfa08e74a1","walletconflicts":[],"time":1523535113,"timereceived":1523535113,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":275,"blocktime":1523535985,"txid":"0380aa14a43add4b3c02081767bd7a185ed4f964cbc0d50f879aff6201006637","walletconflicts":[],"time":1523535114,"timereceived":1523535114,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":275,"blocktime":1523535985,"txid":"0380aa14a43add4b3c02081767bd7a185ed4f964cbc0d50f879aff6201006637","walletconflicts":[],"time":1523535114,"timereceived":1523535114,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":290,"blocktime":1523535985,"txid":"d0d1d1a38a1ae41d820eb8e6b5a98965b8f5e106c3662d9548d94fbe47c615fb","walletconflicts":[],"time":1523535115,"timereceived":1523535115,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":290,"blocktime":1523535985,"txid":"d0d1d1a38a1ae41d820eb8e6b5a98965b8f5e106c3662d9548d94fbe47c615fb","walletconflicts":[],"time":1523535115,"timereceived":1523535115,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":478,"blocktime":1523535985,"txid":"18be64bcf897aef7dc66a1d9b899e5603c35bc243ea3b5d74c1f0c3243bb9f1e","walletconflicts":[],"time":1523535115,"timereceived":1523535115,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":478,"blocktime":1523535985,"txid":"18be64bcf897aef7dc66a1d9b899e5603c35bc243ea3b5d74c1f0c3243bb9f1e","walletconflicts":[],"time":1523535115,"timereceived":1523535115,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":544,"blocktime":1523535985,"txid":"24a2f5aeb2964d43b7531ced70b277465913bceaa11dea48c1ab3eb5caae0250","walletconflicts":[],"time":1523535116,"timereceived":1523535116,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":544,"blocktime":1523535985,"txid":"24a2f5aeb2964d43b7531ced70b277465913bceaa11dea48c1ab3eb5caae0250","walletconflicts":[],"time":1523535116,"timereceived":1523535116,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":554,"blocktime":1523535985,"txid":"d43d705bb20b3b855b7804c30a0789c1b56ad0805991fd1ae63a31c2823b4260","walletconflicts":[],"time":1523535117,"timereceived":1523535117,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":554,"blocktime":1523535985,"txid":"d43d705bb20b3b855b7804c30a0789c1b56ad0805991fd1ae63a31c2823b4260","walletconflicts":[],"time":1523535117,"timereceived":1523535117,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":437,"blocktime":1523535985,"txid":"b18f0517de9d9132e568e2c183df6a61d0c22d385a9efe3d2877ee49fbba8e45","walletconflicts":[],"time":1523535118,"timereceived":1523535118,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":437,"blocktime":1523535985,"txid":"b18f0517de9d9132e568e2c183df6a61d0c22d385a9efe3d2877ee49fbba8e45","walletconflicts":[],"time":1523535118,"timereceived":1523535118,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":263,"blocktime":1523535985,"txid":"09e2a6abc2bad78469eb7c6bd5cd41512314d655fdfbab9a2598ea1b7b870b4d","walletconflicts":[],"time":1523535118,"timereceived":1523535118,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":263,"blocktime":1523535985,"txid":"09e2a6abc2bad78469eb7c6bd5cd41512314d655fdfbab9a2598ea1b7b870b4d","walletconflicts":[],"time":1523535118,"timereceived":1523535118,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":505,"blocktime":1523535985,"txid":"48fa8141b8e8542936608f58414170df107dadc28ee083a1ebf8ee161e8fdf2f","walletconflicts":[],"time":1523535119,"timereceived":1523535119,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":505,"blocktime":1523535985,"txid":"48fa8141b8e8542936608f58414170df107dadc28ee083a1ebf8ee161e8fdf2f","walletconflicts":[],"time":1523535119,"timereceived":1523535119,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":356,"blocktime":1523535985,"txid":"c8bdac849143d8ed8a543cf320899c9c32441b9468c4bc9255c90dccb60c205f","walletconflicts":[],"time":1523535120,"timereceived":1523535120,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":356,"blocktime":1523535985,"txid":"c8bdac849143d8ed8a543cf320899c9c32441b9468c4bc9255c90dccb60c205f","walletconflicts":[],"time":1523535120,"timereceived":1523535120,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":582,"blocktime":1523535985,"txid":"a2b987f86f997cb5494357ea714775ed166d1b901ecf13f6bf98148ec563cfc6","walletconflicts":[],"time":1523535121,"timereceived":1523535121,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":582,"blocktime":1523535985,"txid":"a2b987f86f997cb5494357ea714775ed166d1b901ecf13f6bf98148ec563cfc6","walletconflicts":[],"time":1523535121,"timereceived":1523535121,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":254,"blocktime":1523535985,"txid":"c2b07c2e85bd0b7aebc39957b6fdbb3d213ac472f0a7b9832dc567f508a3ae6e","walletconflicts":[],"time":1523535122,"timereceived":1523535122,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":254,"blocktime":1523535985,"txid":"c2b07c2e85bd0b7aebc39957b6fdbb3d213ac472f0a7b9832dc567f508a3ae6e","walletconflicts":[],"time":1523535122,"timereceived":1523535122,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":583,"blocktime":1523535985,"txid":"09a060cf6a54239ff76268fc9506276f07c28fe87e63b0841622f7fa401ffa99","walletconflicts":[],"time":1523535123,"timereceived":1523535123,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":583,"blocktime":1523535985,"txid":"09a060cf6a54239ff76268fc9506276f07c28fe87e63b0841622f7fa401ffa99","walletconflicts":[],"time":1523535123,"timereceived":1523535123,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":438,"blocktime":1523535985,"txid":"9f0f1ba6031f6cdc3468c04774b16646b80f493c3d8c4b1b1b44e8d25561235b","walletconflicts":[],"time":1523535124,"timereceived":1523535124,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":438,"blocktime":1523535985,"txid":"9f0f1ba6031f6cdc3468c04774b16646b80f493c3d8c4b1b1b44e8d25561235b","walletconflicts":[],"time":1523535124,"timereceived":1523535124,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":551,"blocktime":1523535985,"txid":"83f10219ccd9cae7cddbd553b54c80962808f106af036b8e223b07bef672ef5a","walletconflicts":[],"time":1523535125,"timereceived":1523535125,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":551,"blocktime":1523535985,"txid":"83f10219ccd9cae7cddbd553b54c80962808f106af036b8e223b07bef672ef5a","walletconflicts":[],"time":1523535125,"timereceived":1523535125,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":366,"blocktime":1523535985,"txid":"1daacc2a4eaf5ce4afa582cd354e5fe69384812d0b14efe5d603331c082aaab1","walletconflicts":[],"time":1523535126,"timereceived":1523535126,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":366,"blocktime":1523535985,"txid":"1daacc2a4eaf5ce4afa582cd354e5fe69384812d0b14efe5d603331c082aaab1","walletconflicts":[],"time":1523535126,"timereceived":1523535126,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00150000,"label":"","vout":0,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":605,"blocktime":1523535985,"txid":"04439dbc313187009140c3f8b0cde37eeaed7eaa3516554250361e8d4d97f7dc","walletconflicts":[],"time":1523535127,"timereceived":1523535127,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00150000,"label":"","vout":0,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":605,"blocktime":1523535985,"txid":"04439dbc313187009140c3f8b0cde37eeaed7eaa3516554250361e8d4d97f7dc","walletconflicts":[],"time":1523535127,"timereceived":1523535127,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":593,"blocktime":1523535985,"txid":"8a11bda4fc444d59be89ed967c3d77e59a12fd649931beb87c5c651c4853a7b8","walletconflicts":[],"time":1523535128,"timereceived":1523535128,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"confirmations":4702,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":593,"blocktime":1523535985,"txid":"8a11bda4fc444d59be89ed967c3d77e59a12fd649931beb87c5c651c4853a7b8","walletconflicts":[],"time":1523535128,"timereceived":1523535128,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00750000,"label":"","vout":1,"confirmations":4701,"blockhash":"00000000000002e09820105e9656d3205b6b9f22c359921f5002fe55a1a80745","blockindex":101,"blocktime":1523536449,"txid":"e3bc719f4e6056b4e6b58954b633fe46f4ddb6ec6b40c820720db0731ad6856c","walletconflicts":[],"time":1523536205,"timereceived":1523536205,"bip125-replaceable":"no"},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00750000,"label":"","vout":1,"fee":-0.00000348,"confirmations":4701,"blockhash":"00000000000002e09820105e9656d3205b6b9f22c359921f5002fe55a1a80745","blockindex":101,"blocktime":1523536449,"txid":"e3bc719f4e6056b4e6b58954b633fe46f4ddb6ec6b40c820720db0731ad6856c","walletconflicts":[],"time":1523536205,"timereceived":1523536205,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2N1vFA9NxoMtkKU1fkygjeevzCJ43u7c2tX","category":"receive","amount":0.65000000,"label":"","vout":0,"confirmations":4607,"blockhash":"0000000000000260e06064048725e7e1bfa4272961678fda21da4369c8f2d6cd","blockindex":97,"blocktime":1523604465,"txid":"30af7a090c7e1888b898bb6c379edebc13a85e14c8db3312bf7aece7cf2d0aba","walletconflicts":[],"time":1523604318,"timereceived":1523604318,"bip125-replaceable":"no"},{"account":"","address":"2Mv5zLTEDsHwWo4Sj4ZCQnADpw38MuaJH28","category":"send","amount":-0.19950000,"vout":0,"fee":-0.00001895,"confirmations":4578,"blockhash":"00000000000000a9a09bc52aa7110b7a198f7a61e3d07371ed6e4c4a2a56c130","blockindex":149,"blocktime":1523613198,"txid":"07f9d819ad6e97bcb12ed5aefa125865dfde7721f725112b2c45697ac3058b00","walletconflicts":[],"time":1523611706,"timereceived":1523611706,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2MstWjFhbMhErstzsBGAnJCDkRobNz9somX","category":"send","amount":-0.29950000,"vout":1,"fee":-0.00002441,"confirmations":4568,"blockhash":"00000000e23af851307e0fb07da57d3f2cd55ad1d63381530246afa5d1dc9579","blockindex":246,"blocktime":1523621305,"txid":"20f8103da56b4bb93e75fb0573f06c60e10f1db7c452e930d051e229661217f0","walletconflicts":[],"time":1523618585,"timereceived":1523618585,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED","category":"receive","amount":0.65000000,"label":"","vout":0,"confirmations":4139,"blockhash":"0000000000000195d7d2df25c2032770b9dc3e37d3b0d80b08c0be8ed8b97986","blockindex":9,"blocktime":1523867655,"txid":"7e9eaed64051fb4117c777ff0fc68c2a58b8213e085c52edc882ff061674b218","walletconflicts":[],"time":1523866661,"timereceived":1523866661,"bip125-replaceable":"no"},{"account":"","address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED","category":"receive","amount":0.32500000,"label":"","vout":0,"confirmations":4139,"blockhash":"0000000000000195d7d2df25c2032770b9dc3e37d3b0d80b08c0be8ed8b97986","blockindex":14,"blocktime":1523867655,"txid":"02a22e9e5849ebcb1c5012c4725a1c59e8efa1fbae2f13be7f88cc1104a8997e","walletconflicts":[],"time":1523866843,"timereceived":1523866843,"bip125-replaceable":"no"},{"account":"","address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED","category":"receive","amount":0.16250000,"label":"","vout":0,"confirmations":4139,"blockhash":"0000000000000195d7d2df25c2032770b9dc3e37d3b0d80b08c0be8ed8b97986","blockindex":13,"blocktime":1523867655,"txid":"27d4ba0ce919fba75b22211b0c454860bc18d12dfcf84937e23364ce8e2fa674","walletconflicts":[],"time":1523867311,"timereceived":1523867311,"bip125-replaceable":"no"},{"account":"","address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED","category":"receive","amount":0.08125000,"label":"","vout":0,"confirmations":4128,"blockhash":"0000000000000137d957f8db6b7064db0e2e6c46feef1999d4cf8974b114e13e","blockindex":12,"blocktime":1523871718,"txid":"9f6e4651a3bf2cd268193b3c4731b4dd64b6543246474c799c8be122713b13f5","walletconflicts":[],"time":1523871672,"timereceived":1523871672,"bip125-replaceable":"no"},{"account":"","address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED","category":"receive","amount":0.04062500,"label":"","vout":0,"confirmations":4127,"blockhash":"000000000000022223095294c78cf1907b0aab3e7ad153453ab726859e02affe","blockindex":22,"blocktime":1523872497,"txid":"45b1bb58fff8bbea2aa6388428b6c67410cfcb9ac5a2844e4e13b305c526f460","walletconflicts":[],"time":1523872192,"timereceived":1523872192,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.02031250,"label":"","vout":0,"confirmations":4126,"blockhash":"00000000000002c3f9d35d09f32c0cbbf1cfa1bd9a75497b2b63a0094106a117","blockindex":9,"blocktime":1523873557,"txid":"58db605baaad9da4d8c8fcda2b04f882e0b319c9a27cbc33ff5ba6611ae73116","walletconflicts":[],"time":1523873236,"timereceived":1523873236,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.01015625,"label":"","vout":0,"confirmations":4126,"blockhash":"00000000000002c3f9d35d09f32c0cbbf1cfa1bd9a75497b2b63a0094106a117","blockindex":32,"blocktime":1523873557,"txid":"8e691b3e201951817fe56a0d70ded2923758e9e4d23448dbc673d3911264948d","walletconflicts":[],"time":1523873523,"timereceived":1523873523,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.65000000,"label":"","vout":0,"confirmations":4008,"blockhash":"00000000fadc996c5a7c29d670e91a13842e2cfab046082466ceb7237011b6b1","blockindex":56,"blocktime":1523943840,"txid":"03578e6242467ad17bcf5776b5a681f59c294e18e1e2fed88303b546ff470120","walletconflicts":[],"time":1523942895,"timereceived":1523942895,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.32500000,"label":"","vout":0,"confirmations":4008,"blockhash":"00000000fadc996c5a7c29d670e91a13842e2cfab046082466ceb7237011b6b1","blockindex":58,"blocktime":1523943840,"txid":"06e4e8305e527811a03abc62e85ca05893d8c0e69cfbcbe0a84c43f9cdb0fd33","walletconflicts":[],"time":1523943060,"timereceived":1523943060,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.16250000,"label":"","vout":0,"confirmations":4008,"blockhash":"00000000fadc996c5a7c29d670e91a13842e2cfab046082466ceb7237011b6b1","blockindex":60,"blocktime":1523943840,"txid":"e52b4545a83f01bd284195c8f2568017ae9e062204c39e1f78ca2a74f11e8398","walletconflicts":[],"time":1523943266,"timereceived":1523943266,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.08125000,"label":"","vout":0,"confirmations":4008,"blockhash":"00000000fadc996c5a7c29d670e91a13842e2cfab046082466ceb7237011b6b1","blockindex":61,"blocktime":1523943840,"txid":"71ca1e89bbc719369880fb9f7af9a2a5399ea80b54ef93923548e78027d122cf","walletconflicts":[],"time":1523943470,"timereceived":1523943470,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.04062500,"label":"","vout":0,"confirmations":4007,"blockhash":"0000000000c1dd681b1d3ecee9ba2fe9dd27e07a1debb4ff4788c6dbeaafb7bf","blockindex":61,"blocktime":1523945061,"txid":"f9b7f94e264fe7787d3786f40c545e277db055da4abbaa3400df5fcea3382db5","walletconflicts":[],"time":1523943855,"timereceived":1523943855,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.02031250,"label":"","vout":0,"confirmations":4002,"blockhash":"00000000bbeaa80114dff6610fa54d1528956491145a7cad4959953ca7d49193","blockindex":29,"blocktime":1523949187,"txid":"1c1f5cc3e93e04b88d11ce3163644ea9f0d970c0e633dd39d8b11ed6725d0ffe","walletconflicts":[],"time":1523948861,"timereceived":1523948861,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.01015625,"label":"","vout":0,"confirmations":4002,"blockhash":"00000000bbeaa80114dff6610fa54d1528956491145a7cad4959953ca7d49193","blockindex":20,"blocktime":1523949187,"txid":"8b4d548109b33973df1671a7f23935f79ed08eed3a350e6fc9534513d1164c7a","walletconflicts":[],"time":1523948946,"timereceived":1523948946,"bip125-replaceable":"no"},{"account":"","address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe","category":"receive","amount":0.00507812,"label":"","vout":0,"confirmations":4002,"blockhash":"00000000bbeaa80114dff6610fa54d1528956491145a7cad4959953ca7d49193","blockindex":23,"blocktime":1523949187,"txid":"d8ffa84be7e0aa3da8700665c76fa0bdab181ebd8ac8c35777abb031b575a9cb","walletconflicts":[],"time":1523949103,"timereceived":1523949103,"bip125-replaceable":"no"},{"account":"","address":"2N7FA6nBJeXbtkp18Hd4VDa1osh8x1ixXZQ","category":"receive","amount":0.65000000,"label":"","vout":0,"confirmations":1861,"blockhash":"000000000000005ddb32caf931698e3355ec2369f8e835cfc16e11a9479aee01","blockindex":8,"blocktime":1525068348,"txid":"85b6739896c162e29142e69fcf578adc4e259dcd5b0a0a18d8e5911b4dde9ef1","walletconflicts":[],"time":1525068338,"timereceived":1525068338,"bip125-replaceable":"no"},{"account":"","address":"2MtTy4e1Yc8H4Amf9waxnRvpZGHWUAecz2d","category":"receive","amount":0.20000000,"label":"","vout":1,"confirmations":1853,"blockhash":"0000000000000194ab4032eb4032a6c868f5946cbc1c21210fc08fb6d8e5e8c3","blockindex":41,"blocktime":1525071537,"txid":"888e14b3c1a502acc7fe26c376c77b15e0aa77d4d4a87bb4b64ae3d800b4f96f","walletconflicts":[],"time":1525071181,"timereceived":1525071181,"bip125-replaceable":"no"},{"account":"","address":"2MtTy4e1Yc8H4Amf9waxnRvpZGHWUAecz2d","category":"send","amount":-0.20000000,"label":"","vout":1,"fee":-0.00001375,"confirmations":1853,"blockhash":"0000000000000194ab4032eb4032a6c868f5946cbc1c21210fc08fb6d8e5e8c3","blockindex":41,"blocktime":1525071537,"txid":"888e14b3c1a502acc7fe26c376c77b15e0aa77d4d4a87bb4b64ae3d800b4f96f","walletconflicts":[],"time":1525071181,"timereceived":1525071181,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2NCZ3eDWtuXUXVmkVCXdwrWXKy7Q482xga3","category":"receive","amount":0.65000000,"label":"","vout":0,"confirmations":1801,"blockhash":"00000000000000635f22f5b7d742462c74c627b0a371df2d34b7bd1769ac733a","blockindex":14,"blocktime":1525090256,"txid":"6cded92d001e46d8895306d6e6459b56e9b658e402c2bc894e6af5633979a909","walletconflicts":[],"time":1525089994,"timereceived":1525089994,"bip125-replaceable":"no"},{"account":"","address":"2Mt6ufMDGbH8NVo5E5g9P35N2aaZa4V47a2","category":"receive","amount":0.00100000,"label":"","vout":1,"confirmations":1636,"blockhash":"00000000000002d65363522839c6cac305d3ca0740ee84aab6fd550b18ae7ed1","blockindex":32,"blocktime":1525156798,"txid":"50d80bcd294e2ad5d5b85995104c2219f2d4fdea44e0fc2d4a9aec04ce80441c","walletconflicts":[],"time":1525156538,"timereceived":1525156538,"bip125-replaceable":"no"},{"account":"","address":"2Mt6ufMDGbH8NVo5E5g9P35N2aaZa4V47a2","category":"send","amount":-0.00100000,"label":"","vout":1,"fee":-0.00000348,"confirmations":1636,"blockhash":"00000000000002d65363522839c6cac305d3ca0740ee84aab6fd550b18ae7ed1","blockindex":32,"blocktime":1525156798,"txid":"50d80bcd294e2ad5d5b85995104c2219f2d4fdea44e0fc2d4a9aec04ce80441c","walletconflicts":[],"time":1525156538,"timereceived":1525156538,"bip125-replaceable":"no","abandoned":false},{"account":"","address":"2Mt6ufMDGbH8NVo5E5g9P35N2aaZa4V47a2","category":"receive","amount":0.00100000,"label":"","vout":0,"confirmations":1609,"blockhash":"00000000000000d5e8872c0065065368f7299a152f64a0a57f1b8cb9ffa019ce","blockindex":43,"blocktime":1525169970,"txid":"2ac896f2c193502f629f5132ed9fa2a8453af0410801b83c4ecdb4164d92e62d","walletconflicts":[],"time":1525169274,"timereceived":1525169274,"bip125-replaceable":"no"},{"account":"","address":"2Mt6ufMDGbH8NVo5E5g9P35N2aaZa4V47a2","category":"send","amount":-0.00100000,"label":"","vout":0,"fee":-0.00000348,"confirmations":1609,"blockhash":"00000000000000d5e8872c0065065368f7299a152f64a0a57f1b8cb9ffa019ce","blockindex":43,"blocktime":1525169970,"txid":"2ac896f2c193502f629f5132ed9fa2a8453af0410801b83c4ecdb4164d92e62d","walletconflicts":[],"time":1525169274,"timereceived":1525169274,"bip125-replaceable":"no","abandoned":false}],"error":null,"id":null}'
    end

    before { client.expects(:more_deposits_available?).returns(false) }

    it do
      expected = JSON.load('[{"id":"2ac896f2c193502f629f5132ed9fa2a8453af0410801b83c4ecdb4164d92e62d", "confirmations":1609, "received_at":1525169274,"entries":[{"amount":0.1e-2, "address":"2Mt6ufMDGbH8NVo5E5g9P35N2aaZa4V47a2"}]},{"id":"50d80bcd294e2ad5d5b85995104c2219f2d4fdea44e0fc2d4a9aec04ce80441c","confirmations":1636,"received_at":1525156538,"entries": [{"amount":0.1e-2,"address":"2Mt6ufMDGbH8NVo5E5g9P35N2aaZa4V47a2"}]},{"id":"6cded92d001e46d8895306d6e6459b56e9b658e402c2bc894e6af5633979a909","confirmations":1801,       "received_at":1525089994,"entries":[{"amount":0.65e0,"address":"2NCZ3eDWtuXUXVmkVCXdwrWXKy7Q482xga3"}]},{"id":"888e14b3c1a502acc7fe26c376c77b15e0aa77d4d4a87bb4b64ae3d800b4f96f", "confirmations":1853,"received_at":1525071181,"entries":[{"amount":0.2e0,"address":"2MtTy4e1Yc8H4Amf9waxnRvpZGHWUAecz2d"}]},{"id":"85b6739896c162e29142e69fcf578adc4e259dcd5b0a0a18d8e5911b4dde9ef1","confirmations":1861,"received_at":1525068338,"entries":[{"amount":0.65e0,"address":"2N7FA6nBJeXbtkp18Hd4VDa1osh8x1ixXZQ"}]},{"id":"d8ffa84be7e0aa3da8700665c76fa0bdab181ebd8ac8c35777abb031b575a9cb","confirmations":4002,"received_at":1523949103,"entries": [{"amount":0.507812e-2,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"8b4d548109b33973df1671a7f23935f79ed08eed3a350e6fc9534513d1164c7a","confirmations":4002,"received_at":1523948946,"entries":[{"amount":0.1015625e-1, "address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"1c1f5cc3e93e04b88d11ce3163644ea9f0d970c0e633dd39d8b11ed6725d0ffe","confirmations":4002,"received_at":1523948861,"entries":[{"amount":0.203125e-1,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"f9b7f94e264fe7787d3786f40c545e277db055da4abbaa3400df5fcea3382db5","confirmations":4007,"received_at":1523943855,"entries":[{"amount":0.40625e-1,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"71ca1e89bbc719369880fb9f7af9a2a5399ea80b54ef93923548e78027d122cf","confirmations":4008,"received_at":1523943470,"entries": [{"amount":0.8125e-1,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"e52b4545a83f01bd284195c8f2568017ae9e062204c39e1f78ca2a74f11e8398","confirmations":4008,"received_at":1523943266,"entries":[{"amount":0.1625e0,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"06e4e8305e527811a03abc62e85ca05893d8c0e69cfbcbe0a84c43f9cdb0fd33","confirmations":4008,"received_at":1523943060,"entries":[{"amount":0.325e0,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"03578e6242467ad17bcf5776b5a681f59c294e18e1e2fed88303b546ff470120","confirmations":4008,"received_at":1523942895,"entries":[{"amount":0.65e0,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"8e691b3e201951817fe56a0d70ded2923758e9e4d23448dbc673d3911264948d","confirmations":4126,"received_at":1523873523,"entries":[{"amount":0.1015625e-1,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"58db605baaad9da4d8c8fcda2b04f882e0b319c9a27cbc33ff5ba6611ae73116","confirmations":4126, "received_at":1523873236,"entries":[{"amount":0.203125e-1,"address":"2NBCj3wdNU877ya9zeaY8adhVdarEvVJWUe"}]},{"id":"45b1bb58fff8bbea2aa6388428b6c67410cfcb9ac5a2844e4e13b305c526f460","confirmations":4127,"received_at":1523872192,"entries":[{"amount":0.40625e-1,"address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED"}]},{"id":"9f6e4651a3bf2cd268193b3c4731b4dd64b6543246474c799c8be122713b13f5","confirmations":4128,"received_at":1523871672,"entries":[{"amount":0.8125e-1,"address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED"}]},{"id":"27d4ba0ce919fba75b22211b0c454860bc18d12dfcf84937e23364ce8e2fa674","confirmations":4139,"received_at":1523867311,"entries": [{"amount":0.1625e0, "address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED"}]},{"id":"02a22e9e5849ebcb1c5012c4725a1c59e8efa1fbae2f13be7f88cc1104a8997e","confirmations":4139,"received_at":1523866843,"entries":[{"amount":0.325e0, "address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED"}]},{"id":"7e9eaed64051fb4117c777ff0fc68c2a58b8213e085c52edc882ff061674b218","confirmations":4139,"received_at":1523866661,"entries": [{"amount":0.65e0, "address":"2Mvqp5pCPtctYGFvG2tbtuNxea5jewZaJED"}]},{"id":"30af7a090c7e1888b898bb6c379edebc13a85e14c8db3312bf7aece7cf2d0aba","confirmations":4607,"received_at":1523604318,"entries":[{"amount":0.65e0,"address":"2N1vFA9NxoMtkKU1fkygjeevzCJ43u7c2tX"}]},{"id":"e3bc719f4e6056b4e6b58954b633fe46f4ddb6ec6b40c820720db0731ad6856c","confirmations":4701,"received_at":1523536205,"entries":[{"amount":0.75e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"8a11bda4fc444d59be89ed967c3d77e59a12fd649931beb87c5c651c4853a7b8","confirmations":4702,"received_at":1523535128,"entries":[{"amount":0.5e-3, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"04439dbc313187009140c3f8b0cde37eeaed7eaa3516554250361e8d4d97f7dc","confirmations":4702,"received_at":1523535127,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"1daacc2a4eaf5ce4afa582cd354e5fe69384812d0b14efe5d603331c082aaab1","confirmations":4702,"received_at":1523535126,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"83f10219ccd9cae7cddbd553b54c80962808f106af036b8e223b07bef672ef5a","confirmations":4702,"received_at":1523535125,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"9f0f1ba6031f6cdc3468c04774b16646b80f493c3d8c4b1b1b44e8d25561235b","confirmations":4702,"received_at":1523535124,"entries":[{"amount":0.5e-3, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"09a060cf6a54239ff76268fc9506276f07c28fe87e63b0841622f7fa401ffa99","confirmations":4702,"received_at":1523535123,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"c2b07c2e85bd0b7aebc39957b6fdbb3d213ac472f0a7b9832dc567f508a3ae6e","confirmations":4702,"received_at":1523535122,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"a2b987f86f997cb5494357ea714775ed166d1b901ecf13f6bf98148ec563cfc6","confirmations":4702,"received_at":1523535121,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"c8bdac849143d8ed8a543cf320899c9c32441b9468c4bc9255c90dccb60c205f","confirmations":4702,"received_at":1523535120,"entries":[{"amount":0.5e-3, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"48fa8141b8e8542936608f58414170df107dadc28ee083a1ebf8ee161e8fdf2f","confirmations":4702,"received_at":1523535119,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"09e2a6abc2bad78469eb7c6bd5cd41512314d655fdfbab9a2598ea1b7b870b4d","confirmations":4702,"received_at":1523535118,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"b18f0517de9d9132e568e2c183df6a61d0c22d385a9efe3d2877ee49fbba8e45","confirmations":4702,"received_at":1523535118,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"d43d705bb20b3b855b7804c30a0789c1b56ad0805991fd1ae63a31c2823b4260", "confirmations":4702,  "received_at":1523535117,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"24a2f5aeb2964d43b7531ced70b277465913bceaa11dea48c1ab3eb5caae0250","confirmations":4702,"received_at":1523535116,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"18be64bcf897aef7dc66a1d9b899e5603c35bc243ea3b5d74c1f0c3243bb9f1e","confirmations":4702,"received_at":1523535115,"entries":[{"amount":0.5e-3, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"d0d1d1a38a1ae41d820eb8e6b5a98965b8f5e106c3662d9548d94fbe47c615fb","confirmations":4702,"received_at":1523535115,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"0380aa14a43add4b3c02081767bd7a185ed4f964cbc0d50f879aff6201006637","confirmations":4702,"received_at":1523535114,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"24ee10d5d155fcf4e261be8b0ec5c677e4bef987c13b7d7d484913cfa08e74a1","confirmations":4702,"received_at":1523535113,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"8ecd307512ee1886a929bfe8cbbfa34eda54800a911ca67fa6c2a6fb909be4a9","confirmations":4702,"received_at":1523535113,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"45d3cd09957afbbc5dc985e9ccb15b66b700cf7af857989a59fa9d6460447b31","confirmations":4702,"received_at":1523535112,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"1a844fb42be344df873bd7e0c6385412944da0346214453d706d6414e14d8b7b","confirmations":4702,"received_at":1523535111,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"b485c763abb703498c3c9911dc29b0ee9baf7e363c26311f9114c938514656b7","confirmations":4702,"received_at":1523535111,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"2e16b910fd879ffed43d0f5af066a303348e5caf6461122027a758edc8fb6e88","confirmations":4702,"received_at":1523535110,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"c830ba718273abd19b0e14c3ac344df54918a8a1a9f653956038f7397b5264ed","confirmations":4702,"received_at":1523535110,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"71f469ab6683dcba1e72f1f36fc91f38ad27d78a9daf6c4db0e026162903351d","confirmations":4702,"received_at":1523535109,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"bee7656389e13ff86cee781c60d22ade4c201095021cb1ddc0475f6ae3b56ee9","confirmations":4702,"received_at":1523535108,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"4899faeb025c0c04654fc374e12f4496e4facadaa32e8915c5ec477b1d6c4e28","confirmations":4702,"received_at":1523535107,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"bbdb807d38d4b4b4040d57636c82917eb665b4a0d7ad3acb5151c974e14298b0","confirmations":4702,"received_at":1523535107,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"b9a101a073080b4fb6b7ab5463b05597729dc4e5328c616f200ab2f9ad6a2db4","confirmations":4702,"received_at":1523535106,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"4ed6419c482f90509adf497520bd85cd031763a0a3eede20acb0ca9a65968460","confirmations":4702,"received_at":1523535104,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"5c7aa61e159db5a53049372fb8b76bf5bdb673ea09d0516b3fc77fe4d4d61eaa","confirmations":4702,"received_at":1523535103,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"68703ae38942d0f7b0c2b3a6530f445f1df1f20d2acad9d68b0a2e51681e9747","confirmations":4702,"received_at":1523535102,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"059f5069dc50538231bfd08f68f7805bb9d25a8f96d77a60f43de341aca3b2f5","confirmations":4702,"received_at":1523535102,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"d26e5de3f9a2bdc07a28175d06cf51ba1c3361ea7b8c6aec01ce6e4c798203d4","confirmations":4702,"received_at":1523535101,"entries":[{"amount":0.15e-2, "address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"fd0e7e0d21b000d39716df5a46399cc4087137e2dbdb3de4ff4db907ce58b9df","confirmations":4702,"received_at":1523535100,"entries":[{"amount":0.5e-3,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]},{"id":"44bbd357cbac7663a2d4b3f5ec44def42a532f89a1a48d0a930e4016812a88c1","confirmations":4702,"received_at":1523535099,"entries":[{"amount":0.15e-2,"address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB"}]}]').map(&:symbolize_keys)
      expected.each do |tx|
        tx[:received_at] = Time.at(tx[:received_at])
        tx[:entries].each(&:symbolize_keys!).each { |entry| entry[:amount] = entry[:amount].to_d }
      end
      is_expected.to eq expected
    end
  end

  describe '#load_deposit!' do
    let(:hash) { 'fd0e7e0d21b000d39716df5a46399cc4087137e2dbdb3de4ff4db907ce58b9df' }
    subject { client.load_deposit!(hash) }

    let :request_body do
      { jsonrpc: '1.0',
        method:  'gettransaction',
        params:  [hash]
      }.to_json
    end

    let :response_body do
      '{"result":{"amount":0.00000000,"fee":-0.00000257,"confirmations":4738,"blockhash":"00000000e92125f72f0e132d324d16a7693ddda53d2e8545b701c2baa076dc01","blockindex":608,"blocktime":1523535985,"txid":"fd0e7e0d21b000d39716df5a46399cc4087137e2dbdb3de4ff4db907ce58b9df","walletconflicts":[],"time":1523535100,"timereceived":1523535100,"bip125-replaceable":"no","details":[{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"send","amount":-0.00050000,"label":"","vout":1,"fee":-0.00000257,"abandoned":false},{"account":"","address":"2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB","category":"receive","amount":0.00050000,"label":"","vout":1}],"hex": "020000000001024a97da778f9882f65546e62ec9aee3dbbe7c25fa585a147926b1d81e992013270100000017160014800b4788ef66faefdcc6a3e64dc60872a9c757c7feffffffe723c21b0bad8ae854a5043b6b323a3ee05bbb8c26878ab4095bf23bc1d1c43b01000000171600143eecb6c1a17fcdbebdf197b6a07eb7436476469efeffffff0298e20f000000000017a914588efda1527c61b00cda3876439ac6df6c4e0f8b8750c300000000000017a914b8e7996763e653b1fe618577ec7672e6add09de68702483045022100c5eb3113e49b965b7cf516d3cc9e70eba421439d26890fa1bdc319bdfceba6bd02201473e4a29705a74fb741b1b48b519bb69f33bbf987eee6fc8374cde865cd49d5012103e1b3043e86fd175b7cae3b0bc91e005f6aaeecb66949560e4f0310e28da8f9ce02483045022100f49085c0ea0945ad806d2d4dfe7743b15edb6447b069117b3c28b45ab835d7c9022008bda8d2348ce9d9169bdf2e9a3e0434f7b4bf2d30ade14fa04e1f380e1eed03012102e4b431866f1e1e771b452ad1540e1cbbb959889515a76298fe06ba7266c45d1afab81300"},"error":null,"id":null}'
    end

    it do
      is_expected.to eq \
        id:            'fd0e7e0d21b000d39716df5a46399cc4087137e2dbdb3de4ff4db907ce58b9df',
        confirmations: 4738,
        received_at:   Time.at(1523535100),
        entries:       [{ address: '2NA6umNrb57TCGGN2cj49sSdW5SzpcVaqYB', amount: 0.00050000.to_d }]
    end
  end

  describe 'create_withdrawal!' do
    let(:issuer) { { address: '2NCugEoy5CsCbcqpB7EzZSo3Wbv2hSuegcb' } }
    let(:recipient) { { address: '2N7r9zKXkypzqtXfWkKfs3uZqKbJUhdK6JE' } }
    subject { client.create_withdrawal!(issuer, recipient, 0.01) }

    let :set_fee_request_body do
      { jsonrpc: '1.0', method: 'settxfee', params: [0.65] }.to_json
    end

    let :set_fee_response_body do
      { result: true }.to_json
    end

    let :create_tx_request_body do
      { jsonrpc: '1.0', method: 'sendtoaddress', params: ['2N7r9zKXkypzqtXfWkKfs3uZqKbJUhdK6JE', 0.01] }.to_json
    end

    let :create_tx_response_body do
      { result: 'dcedf50780f251c99e748362c1a035f2916efb9bb44fe5c5c3e857ea74ca06b3' }.to_json
    end

    before do
      stub_request(:post, 'http://127.0.0.1:18332/').with(body: set_fee_request_body).to_return(body: set_fee_response_body)
      stub_request(:post, 'http://127.0.0.1:18332/').with(body: create_tx_request_body).to_return(body: create_tx_response_body)
    end

    it { is_expected.to eq('dcedf50780f251c99e748362c1a035f2916efb9bb44fe5c5c3e857ea74ca06b3') }
  end
end
